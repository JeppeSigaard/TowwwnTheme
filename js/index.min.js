var EventContentModule={settings:{cb:function(){},ready:!1,get_url:rest_api+"events?per_page=100&after=now&page=",upcoming_get_url:rest_api+"events?page=1&after=now&per_page=",page_counter:1,default_appendSelector:".eventscontainer",events:[],tmp_events:[]},init:function(e){this.settings.cb=e,this.get_upcoming_events(25)},get_upcoming_events:function(e){var t=new XMLHttpRequest;t.onload=function(e){for(var t=$.parseJSON(e.target.response),i=0;i<t.length;i++)this.settings.events.push(t[i]);this.settings.ready=!0,this.settings.cb(!0),this.get_events()}.bind(this),t.open("GET",this.settings.upcoming_get_url+e),t.send()},get_events:function(){var e=new XMLHttpRequest;e.onload=function(e){for(var t=$.parseJSON(e.target.response),i=0;i<t.length;i++)this.settings.tmp_events.push(t[i]);return t.length<1?(this.render_ready=!0,this.settings.page_counter=0,this.settings.tmp_events.sort(function(e,t){return e.start_time<t.start_time?-1:e.start_time>t.start_time?1:0}),this.settings.events=this.settings.tmp_events,this.settings.tmp_events=[],void this.settings.cb(!1)):(this.settings.page_counter++,void this.get_events())}.bind(this),e.open("GET",this.settings.get_url+this.settings.page_counter.toString()),e.send()}},LocationCategoryModule={settings:{ready:!1,unsorted_location_categories:{},sorted_location_categories:[]},init:function(){this.get_location_categories()},get_location_categories:function(){for(var e=LocationModule.settings.locations,t=0;t<e.length;t++)for(var i=0;i<e[t].categories.length;i++){var n=e[t].categories[i];"undefined"==typeof this.settings.unsorted_location_categories[n.category_name]?this.settings.unsorted_location_categories[n.category_name]={category_counter:1,category_name:n.category_name,category_imgurl:n.category_imgurl}:this.settings.unsorted_location_categories[n.category_name].category_counter++}var s=[];for(var o in this.settings.unsorted_location_categories){for(var a=!1,t=0;t<s.length;t++)if(this.settings.unsorted_location_categories[o].category_counter>s[t].category_counter){s.splice(t,0,this.settings.unsorted_location_categories[o]),a=!0;break}a||s.push(this.settings.unsorted_location_categories[o])}this.settings.sorted_location_categories=s,this.settings.ready=!0},render_location_categories:function(e){for(var t='<div class="category-bar">Kategorier</div><div class="category-container">',i=0;i<this.settings.sorted_location_categories.length;i++)t+=this.generate_category_html(this.settings.sorted_location_categories[i]);$(e).html(t+="</div>")},generate_category_html:function(e){var t='<div class="category" style="background-image:url('+e.category_imgurl+')">';return t+='<div class="category-content-container">',t+='<div class="category-title">'+e.category_name+"</div>",t+='<div class="category-count">'+e.category_counter+"</div></div></div>"}},LocationModule={settings:{ready:!1,page_counter:1,locations:[],callback:null},init:function(e){this.settings.callback=e,this.get_locations()},get_locations:function(){var e=new XMLHttpRequest;e.onload=function(e){for(var t=$.parseJSON(e.target.response),i=0;i<t.length;i++)this.settings.locations.push(t[i]);t.length<1?(this.settings.page_counter=0,this.settings.ready=!0,this.settings.callback()):(this.settings.page_counter++,this.get_locations())}.bind(this),e.open("GET",rest_api+"locations?per_page=100&after=now&page="+this.settings.page_counter),e.send()},render_locations:function(){},generate_location_html:function(){}},ImageController={settings:{backImages:!0,loaderReady:!1,state:-1,large_ready:!1,medium_ready:!1,small_ready:!1,size_large:1400,size_medium:950,size_small:500},init:function(){var e=new XMLHttpRequest;e.onload=function(){ImageController.settings.loaderReady=!0},e.open("GET",template_uri+"/style/assets/icons/loading.svg"),e.send(),this.headerImgControl(),$(".slide-img").each(function(e,t){var i=new XMLHttpRequest;i.open("GET",$(this).attr("data-src-large")),i.send(),i=new XMLHttpRequest,i.open("GET",$(this).attr("data-src-medium")),i.send(),i=new XMLHttpRequest,i.open("GET",$(this).attr("data-src-small")),i.send()}),$(window).trigger("scroll"),this.bindUIActions()},bindUIActions:function(){$(window).on("resize",function(){this.headerImgControl(),this.lazyLoad()}.bind(this)),$(window).on("scroll",function(){this.lazyLoad()}.bind(this))},isInView:function(e){var t=$(window).scrollTop(),i=t+$(window).height(),n=e.offset().top,s=n+e.height();return s<=i&&n>=t},lazyLoad:function(){$("[data-image-src]").each(function(e,t){var t=$(this),i=t.attr("data-image-src"),n=t.attr("data-src");if(ImageController.isInView(t)){t.addClass("imgloaded"),ImageController.settings.loaderReady&&(ImageController.settings.backImages?t.css("background-image","url("+template_uri+"/style/assets/icons/loading.svg)").addClass("loading"):t.attr("src",template_uri+"/style/assets/icons/loading.svg").addClass("loading"));var s=new XMLHttpRequest;s.onload=function(){ImageController.settings.backImages?t.css("background-image","url("+i+")"):t.attr("src",n),t.removeAttr("data-image-src").removeClass("loading")}.bind(this),s.open("GET",i),s.send()}})},headerImgControl:function(){var e=this.settings,t=e.size_medium+(e.size_large-e.size_medium)/2,i=e.size_small+(e.size_medium-e.size_small)/2;$(".slide-img").each(function(e,n){$(window).innerWidth()>t?$(this).css("background-image","url("+$(this).attr("data-src-large")+")"):$(window).innerWidth()>i?$(this).css("background-image","url("+$(this).attr("data-src-medium")+")"):$(this).css("background-image","url("+$(this).attr("data-src-small")+")")})}},ViewControllerModule={settings:{ready:!1,bbActive:!1,backButton:$(".back-button"),betaWarning:$(".beta-warning"),socialMedia:$(".socialmedia"),mobile:!1},init:function(){this.update(),this.bindUIActions(),this.settings.ready=!0},update:function(){$(window).innerWidth()<=640?(this.settings.mobile=!0,this.settings.backButton.addClass("mobile")):(this.settings.mobile=!1,this.settings.backButton.removeClass("mobile"))},bindUIActions:function(){$(document).on("click",".event",function(){this.activeBackButton()}.bind(this)),$(window).on("resize",this.update.bind(this)),this.settings.backButton.on("click",function(){this.settings.mobile&&ViewHandler.go_to(0),this.disableBackButton(),ViewHandler.closeSingleView()}.bind(this))},activeBackButton:function(){this.settings.bbActive||(setTimeout(function(){this.settings.backButton.addClass("active")}.bind(this),300),this.settings.betaWarning.removeClass("active"),this.settings.socialMedia.removeClass("active"),this.settings.bbActive=!0)},disableBackButton:function(){this.settings.bbActive&&(this.settings.backButton.removeClass("active"),setTimeout(function(){this.settings.betaWarning.addClass("active"),this.settings.socialMedia.addClass("active")}.bind(this),300),this.settings.bbActive=!1)}},EventCalenderModule={settings:{html:"",breakpointHtml:"",breakpoint:-1,breakpointArray:[],breakpointFrom:-1,breakpointTo:-1,breakpointView:"",page:2},init:function(){this.bindUIActions()},bindUIActions:function(){$(window).on("resize",function(){EventCalenderModule.setEventCalendarWidth()})},renderEventCalender:function(e,t){this.settings.breakpointView=e;var i=!1,n=25,s=-1,o=-1,a=!1,r=!0;if("undefined"!=typeof t.acceptOld&&(i=t.acceptOld),"undefined"!=typeof t.getNum&&(n=t.getNum),"undefined"!=typeof t.from&&(s=t.from),"undefined"!=typeof t.to&&(o=t.to),"undefined"!=typeof t.content&&(a=t.content,r=!1),a)this.settings.breakpointArray=t.content,this.settings.breakpoint=n,a=a.slice(0,n);else{var a=[],l=EventContentModule.settings.events,c;for(c=0;c<l.length;c++){if(a.length>n){this.settings.breakpoint=c;break}var d=new Date(l[c].start_time.substr(0,16)).getTime();!i&&d<(new Date).getTime()||s!==-1&&s>d||o!==-1&&o<d||a.push(l[c])}this.settings.breakpointArray=l}this.settings.breakpointFrom=s,this.settings.breakpointTo=o;for(var c=0;c<a.length;c++)this.settings.html+=this.generateEventHtml(a[c]);this.settings.breakpointHtml=this.settings.html,$(e).html(this.settings.html),this.settings.html=""},loadMore:function(e){for(var t=[],i=this.settings.breakpointArray,n=this.settings.breakpoint;n<i.length;n++){var s=new Date(i[n].start_time.substr(0,16)).getTime();if(t.length>=e){this.settings.breakpoint=n;break}this.settings.breakpointFrom!==-1&&this.settings.breakpointFrom>s||this.settings.breakpointTo!==-1&&this.settings.breakpointTo<s||t.push(i[n])}if(t.length<e&&(this.settings.breakpoint=i.length),0===t.length)return-1;this.settings.breakpointHtml="";for(var n=0;n<t.length;n++)this.settings.breakpointHtml+=this.generateEventHtml(t[n]);return $(this.settings.breakpointView).append(this.settings.breakpointHtml),setTimeout(function(){$(window).trigger("resize")},150),i.length-this.settings.breakpoint},generateEventHtml:function(e){var t="",i=HelpFunctions.formatDate(e.start_time,!1,!1),n=String(e.name).substr(0,36)+String(e.name).substr(36,99).split(" ")[0];n.length!==String(e.name).length&&(n+=" ...");for(var s=n.split(" "),o=0;o<s.length;o++)s[o].length>14&&(s[o]=s[o].substr(0,14)+"-<br />"+s[o].substr(12,999999999));n=s.join(" ");var t='<div class="event" id="'+e.id+'">';return"undefined"!=typeof e.images&&null!==e.images[130]&&"undefined"!=typeof e.images[130]?(t+='<div class="imgcontainer" data-image-src="'+e.images[130]+'" >',t+='<div class="loader"><img src="'+template_uri+'/style/assets/icons/loading-white.svg" /></div></div>'):""!==e.imgurl&&null!==e.imgurl&&"undefined"!=typeof e.imgurl?(t+='<div class="imgcontainer" data-image-src="'+e.imgurl+'" >',t+='<div class="loader"><img src="'+template_uri+'/style/assets/icons/loading-white.svg" /></div></div>'):(t+='<div class="imgcontainer imgloaded" style="background-image:url(http://www-mtl.mit.edu/wpmu/marc2016/files/2015/08/placeholder-camera-green.png)" >',t+='<div class="loader"><img src="'+template_uri+'/style/assets/icons/loading-white.svg" /></div></div>'),t+='<div class="eventtext">',t+='<div class="title">'+n+"</div>",t+='<div class="start_time">'+i+"</div>",t+='<div class="eventlocation-container">',t+='<div class="eventblackbar"></div>',t+='<div class="eventlocation">'+e.parentname+"</div></div></div></div>"},setEventCalendarWidth:function(){var e=-1,t=0,i=!0;$(".event").each(function(n,s){if(e===-1)e=s.offsetTop,t++;else{if(e!==s.offsetTop)return void(i=!1);t++}});var n=$(".eventscontainer").children(),s=n.length%t;if(n.css("max-width","none").removeClass("last-row"),i===!1)for(var o=0;o<s;o++)$("#"+n[n.length-(o+1)].attributes.id.value).css("max-width",$("#"+n[0].attributes.id.value).outerWidth()+"px").addClass("last-row");else $(".eventscontainer").hasClass("lineLayout")||n.css("max-width","195px").addClass("last-row")}},EventSingleModule={settings:{callback:function(){},elem:null,elem_back:""},init:function(){},bindUIActions:function(){},render_sv_event:function(e,t,i){this.settings.elem=i,$(".imgcontainer",i).addClass("loadingsv"),this.settings.callback=t;var n;$.get(rest_api+"events/"+e,function(e){if("undefined"!=typeof e[0]){n=e[0],ViewHandler.settings.right_container.html(EventSingleModule.generate_sv_event_html(n)),ViewHandler.settings.right_container.addClass("active"),ViewHandler.settings.left_container.addClass("active"),ViewHandler.settings.right_container.parents(".sync-outer").scrollTop(0);var t=!0;$(".event-footer-block").each(function(e,i){t?t=!1:($(this).addClass("dark"),t=!0)}),$(".event-sv-info-placeholder").css({height:$(".event-sv-info").outerHeight()+"px"}),ViewHandler.settings.right_container.removeClass("spoopy"),setTimeout(function(){$(window).trigger("resize")},200),setTimeout(function(){$(".imgcontainer",EventSingleModule.settings.elem).removeClass("loadingsv"),EventSingleModule.settings.callback()},300)}}.bind(this))},generate_sv_event_html:function(e){var t=e.description;null===t&&(t="  ");var i=HelpFunctions.nl2p(HelpFunctions.linkifier(t)),n=HelpFunctions.formatDate(e.start_time,!0,!0),s='<div class="event-bar">'+e.parentname+'<div class="close-button">&times;</div></div>';return s+='<div class="event-sv-content-container">',s+='<div class="event-singleview">',s+=""!==e.imgurl&&null!==e.imgurl&&"undefined"!=typeof e.imgurl?'<div class="event-sv-img" style="background-image:url('+e.imgurl+');"></div>':'<div class="event-sv-img" style="background-image:url(http://www-mtl.mit.edu/wpmu/marc2016/files/2015/08/placeholder-camera-green.png);"></div>',s+='<div class="event-sv-title">'+e.name+"</div>",s+='<div class="event-sv-start-time">'+n+"</div>",s+='<hr class="lineBreak" />',s+='<div class="es-btns">',s+='<div class="status-btn share" data-link="https://www.facebook.com/events/'+e.fbid+'"><div class="icon"><svg viewbox="0 0 32 32" ><use xlink:href="#icon-facebook"></use></svg></div>',s+='<div class="text">Del</div></div>',""!==e.ticket_uri&&null!==e.ticket_uri&&(s+='<div class="status-btn ticket" data-link="'+e.ticket_uri+'">',s+='<div class="icon"><svg viewbox="0 0 32 32"><use xlink:href="#icon-ticket"></use></svg></div>',s+='<div class="text">Køb billet</div></div>'),s+='</div><hr class="lineBreak" />',s+='<div class="event-sv-desc">'+i+"</div>",s+="</div>",s+='<div class="event-sv-info-placeholder"></div>',s+='<div class="event-sv-info">',s+='<div class="event-footer-block title"><div class="icon" style="background-image: url('+e.parentpicture+');"></div><div class="value">'+e.parentname+"</div></div>",s+='<div class="event-footer-block clickable" data-link="http://fb.com/'+e.parentid+'"><div class="icon"><svg viewbox="0 0 32 32"><use xlink:href="#icon-facebook"></use></svg></div><div class="value">'+e.parentname+"</div></div>",null!==e.website&&"undefined"!=typeof e.website&&(s+='<div class="event-footer-block clickable" data-link="'+e.website+'"><div class="icon"><svg viewbox="0 0 32 32"><use xlink:href="#icon-web"></use></svg></div><div class="value"  >'+e.website+"</div></div>"),null!==e.phone&&"undefined"!=typeof e.phone&&(s+='<div class="event-footer-block clickable" data-link-type="redirect" data-link="tel://'+e.phone+'"><div class="icon"><svg viewbox="0 0 32 32"><use xlink:href="#icon-phone"></use></svg></div><div class="value">'+e.phone+"</div></div>"),null!==e.adress&&"undefined"!=typeof e.adress&&(s+='<div class="event-footer-block clickable" data-link="https://google.dk/maps/search/'+e.adress+', svendborg"><div class="icon"><svg viewbox="0 0 32 32"><use xlink:href="#icon-address"></use></svg></div><div class="value">'+e.adress+"</div></div>"),s+="</div></div>",""!==commercial_image_url&&(s+='<div class="commercial-placeholder"></div>',s+='<a href="'+commercial_link+'"><div class="commercial-img" style="background-image:url('+commercial_image_url+');"></div></a>'),s}},FrontPageModule={settings:{ready:!1,lc:"",loadMoreGetNum:25},init:function(e){var t='<div id="eventsbar">';t+='<div id="eventslayoutbtns">',t+='<img class="blocklayoutbtn" src="'+template_uri+'/style/assets/icons/blockLayout.PNG" />',t+='<img class="linelayoutbtn" src="'+template_uri+'/style/assets/icons/lineLayout.PNG" /></div>',t+='<div class="monthSelector"></div>',t+='</div><div class="picker"></div>',t+='<div class="eventscontainer"></div>',t+=e?'<div class="load-more">Indlæser flere elementer...</div>':'<div class="load-more">Indlæs '+this.settings.loadMoreGetNum+" mere</div>",this.settings.lc=t,e&&ViewHandler.settings.left_container.html(t),this.generate_front_page(e)},generate_front_page:function(e){e&&(ViewHandler.closeSingleView(),ViewControllerModule.disableBackButton(),ViewHandler.settings.poly_view?ViewHandler.closeSingleView():ViewHandler.settings.left_container.removeClass("active"),$(".eventscontainer").removeClass("lineLayout")),ViewHandler.settings.left_container.html(this.settings.lc),this.bindUIActions(),EventCalenderModule.renderEventCalender(".eventscontainer",{getNum:0,acceptOld:!1}),$(".load-more").trigger("click"),e&&$(".load-more").html("Indlæser flere elementer..."),ViewHandler.bindUIActions(),this.updateLayoutPosition(),ViewControllerModule.disableBackButton(),setTimeout(function(){$(window).trigger("resize")},250),this.settings.ready=!0},bindUIActions:function(){this.settings.ready||$(".logo-container").on("click",function(e){$("body").hasClass("app")&&e.preventDefault(),this.generate_front_page(),$("#searchfield").val("")}.bind(this)),$(document).on("click",".event",function(){this.updateLayoutPosition()}.bind(this)),$(".load-more").on("click",function(){var e=EventCalenderModule.loadMore(this.settings.loadMoreGetNum);e>this.settings.loadMoreGetNum&&(e=this.settings.loadMoreGetNum),e>0?$(".load-more").html("Indlæs "+e+" mere"):$(".load-more").html("Alt indhold indlæst"),setTimeout(function(){$(window).trigger("scroll"),syncScroll.rescaleContainer()},150)}.bind(this)),$(".blocklayoutbtn").on("click",function(){$(".eventscontainer").removeClass("lineLayout"),ViewHandler.reload_view(!0)}),$(".linelayoutbtn").on("click",function(){$(".eventscontainer").addClass("lineLayout"),ViewHandler.reload_view(!0)}),$(".monthSelector").monthPicker({appendSelector:".picker"},function(e){$(".eventscontainer").html(""),EventCalenderModule.renderEventCalender(".eventscontainer",{getNum:0,acceptOld:!0,from:e[0].month_from,to:e[0].month_to});var t=EventCalenderModule.loadMore(25);t===-1&&$(".eventscontainer").html('<div class="error">Ingen elementer fundet</div>'),this.updateLayoutPosition(),setTimeout(function(){syncScroll.rescaleContainer(),$(window).trigger("resize")},100)}.bind(this))},updateLayoutPosition:function(){}},HeaderModule={settings:{menu_ready:!1,breakpoint:0,views:[],startScroll:$(window).scrollTop()},init:function(){var e=$(".header-commercials").find(".swiper-slide").length;if(e>1)var t=new Swiper(".header-commercials",{direction:"horizontal",loop:!0,autoplay:9e3,autoplayDisableOnInteraction:!1,pagination:".header-commercial-bullets",paginationType:"bullets",paginationClickable:!0});this.bindUIActions()},bindUIActions:function(){this.settings.menu_ready=!1,$(window).on("scroll",function(){Math.abs($(window).scrollTop()-this.settings.startScroll)>10&&($(".header-container").removeClass("active"),$(".menu-show-btns").removeClass("active"),this.settings.breakpoint=$("#header").height()+$("#header").position().top,$(window).scrollTop()>=this.settings.breakpoint?($(".header-container").addClass("fixed"),$(".header-placeholder").addClass("fixed"),$(".menu-show-btns").addClass("show"),$(".event-singleview").addClass("fixed"),this.settings.menu_ready=!0):($(".header-container").removeClass("fixed"),$(".header-placeholder").removeClass("fixed"),$(".menu-show-btns").removeClass("show"),$(".event-singleview").removeClass("fixed"),this.settings.menu_ready=!1),$(window).innerWidth()<=640&&($(".header-container").addClass("fixed"),$(".header-placeholder").addClass("fixed"),$(".menu-show-btns").addClass("show"),$(".event-singleview").addClass("fixed"),this.settings.menu_ready=!0))}.bind(this)),$(window).trigger("scroll"),$(window).on("resize",function(){$(this).trigger("scroll")}),$(".menu-show-btns").on("click",this.show_menu.bind(this)),$(window).on("keydown",function(e){$(window).scrollTop()>$("#header").height()&&!$(".header-container").hasClass("active")&&32===e.keyCode?(e.preventDefault(),$("#searchfield").select(),this.show_menu()):$(window).scrollTop()>$("#header").height()&&$(".header-container").hasClass("active")&&32===e.keyCode&&(""!==$("#searchfield").val()&&" "!==$("#searchfield").val()||(e.preventDefault(),$("#searchfield").val(""),this.show_menu()))}.bind(this))},show_menu:function(e){"undefined"==typeof e&&(e=!1),this.settings.menu_ready&&($(".menu-show-btns").hasClass("active")||e===!0?($(".menu-show-btns").removeClass("active"),$(".header-container").removeClass("active")):(this.settings.startScroll=$(window).scrollTop(),$("#searchfield").select(),$(".menu-show-btns").addClass("active"),$(".header-container").addClass("active")))}},MobileLayoutModule={settings:{ready:!1,bbActive:!1,backButton:$(".back-button"),betaWarning:$(".beta-warning"),socialMedia:$(".socialmedia")},init:function(){this.bindUIActions(),this.settings.ready=!0},bindUIActions:function(){$(document).on("click",".event",function(){this.activeBackButton()}.bind(this)),this.settings.backButton.on("click",function(){ViewHandler.go_to(0),this.disableBackButton()}.bind(this))},activeBackButton:function(){this.settings.bbActive||(setTimeout(function(){this.settings.backButton.addClass("active")}.bind(this),300),this.settings.betaWarning.removeClass("active"),this.settings.socialMedia.removeClass("active"),this.settings.bbActive=!0)},disableBackButton:function(){this.settings.bbActive&&(this.settings.backButton.removeClass("active"),setTimeout(function(){this.settings.betaWarning.addClass("active"),this.settings.socialMedia.addClass("active")}.bind(this),300),this.settings.bbActive=!1)}},ViewControllerModule={settings:{ready:!1,bbActive:!1,backButton:".event-bar .close-button",betaWarning:$(".beta-warning"),socialMedia:$(".socialmedia"),mobile:!1},init:function(){this.update(),this.bindUIActions(),this.settings.ready=!0},update:function(){},bindUIActions:function(){$(document).on("click",".event",function(){this.activeBackButton()}.bind(this)),$(window).on("resize",this.update.bind(this)),$(document).on("click",this.settings.backButton,function(){ViewHandler.closeSingleView()}.bind(this))},activeBackButton:function(){},disableBackButton:function(){}},HelpFunctions={numOfIncludes:function(e,t){for(var i=0,n=0;n!==-1;)n=e.indexOf(t,n),n!==-1&&(i++,n++);return i},nl2p:function(e){return e.length>0?"<p>"+e.replace(/[\r\n]+/g,"</p><p>")+"</p>":null},linkifier:function(e){var t=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,i=e.replace(t,'<a href="$1" target="_blank">$1</a>'),n=/(^|[^\/])(www\.[\S]+(\b|$))/gim,i=i.replace(n,'$1<a href="http://$2" target="_blank">$2</a>'),s=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim,i=i.replace(s,'<a href="mailto:$1">$1</a>');return i},formatDate:function(e,t,i){var n=new Date(e.substr(0,16)),s="";if(i){var o=["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"];s+=o[n.getDay()]+" d. "}return s+=parseInt(n.getDate())+" / "+parseInt(n.getMonth()+1)+" - "+parseInt(n.getFullYear()),t&&(s+=n.getMinutes()<10?" kl. "+(n.getHours()-1)+":0"+n.getMinutes():" kl. "+(n.getHours()-1)+":"+n.getMinutes()),s}};jQuery.prototype.monthPicker=function(e,t){var i="monthPicker_selector";if(e.remove===!0)return $("."+i).removeClass("active"),$(this).removeClass("pickerActive"),void setTimeout(function(){$("."+i).remove()},150);var n=null;"undefined"!=typeof e.appendSelector&&null!==e.appendSelector&&(n=e.appendSelector);var s=null;"undefined"!=typeof e.years&&null!==e.years&&(s=e.years);for(var o={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"Maj",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Okt",10:"Nov",11:"Dec"},s=[],a=2010;a<=2020;a++)s.push(a.toString());var r=$(this),l='<div class="'+i+'">',c=[],d=null;for(var g in s)for(var h in o)l+='<div class="month" data-key="'+h+'" id="'+s[g]+"-"+h+'"><div class="monthTitle">'+o[h]+"</div>",l+='<div class="yearTitle" data-key="'+s[g]+'">'+s[g]+"</div></div>";l+="</div>",r.html('Kommende begivenheder <div class="pickerArrow"></div>'),r.click(function(){if(setTimeout(function(){syncScroll.rescaleContainer()},200),$(this).hasClass("pickerActive"))$("."+i).removeClass("active"),$(this).removeClass("pickerActive"),setTimeout(function(){$("."+i).remove()},150);else{if(null!==n?$(n).append(l):$("body").append(l),$(this).addClass("pickerActive"),$("."+i).flickity({cellAlign:"center",prevNextButtons:!1,pageDots:!1}),$("."+i).addClass("active"),1===c.length)$("."+i+" #"+c[0]).addClass("active");else if(c.length>1){$("."+i+" #"+c[0]).addClass("active-left"),$("."+i+" #"+c[c.length-1]).addClass("active-right");for(var e=1;e<c.length-1;e++)$("."+i+" #"+c[e]).addClass("active-middle")}var a=new Date,g=(new Date).getFullYear().toString(),h=(new Date).getMonth().toString(),u;for(u=0;u<s.length;u++)if(s[u]===g){u*=12;break}for(var v in o)o.key===h&&(u+=parseInt(v));console.log(u),$("."+i).flickity("select",u),$("."+i+" .month").click(function(){$("."+i+" .month").removeClass("active"),$("."+i+" .month").removeClass("active-left"),$("."+i+" .month").removeClass("active-middle"),$("."+i+" .month").removeClass("active-right"),c=[];var e=parseInt($(this).attr("data-key")),n=parseInt($(".yearTitle",this).attr("data-key")),s=new Date(n,e).getTime(),a=new Date(n,e+1).getTime();if(null!==d){if($(this).attr("data-key")===d.attr("data-key"))return d.removeClass("active"),r[0].month_from=(new Date).getTime(),r[0].month_to=new Date(3e3,1).getTime(),d=null,r.html('Kommende begivenheder <div class="pickerArrow"></div>'),void t(r);var l=parseInt(d.attr("data-key")),g=parseInt($(".yearTitle",d).attr("data-key")),h=0,u=0,v=0,m=0;new Date(g,l).getTime()<new Date(n,e).getTime()?(s=new Date(g,l).getTime(),h=l,v=g,a=new Date(n,e+1).getTime(),u=e,m=n,d.addClass("active-left"),$(this).addClass("active-right")):(s=new Date(n,e).getTime(),h=e,v=n,a=new Date(g,l+1).getTime(),u=l,m=g,$(this).addClass("active-left"),d.addClass("active-right")),r.html(o[h]+" "+String(v).substr(2,3)+" - "+o[u]+" "+String(m).substr(2,3)+'<div class="pickerArrow"></div>'),d=null}else d=$(this),$(this).addClass("active"),r.html(o[$(this).attr("data-key")]+" "+$(".yearTitle",this).attr("data-key")+'<div class="pickerArrow"></div>'),c.push($(".yearTitle",this).attr("data-key")+"-"+$(this).attr("data-key"));for(var f=v;f<m+1;f++)for(var p=h;p<u+1;p++)c.push(f+"-"+p);if("undefined"!==v&&"undefined"!==m)if(parseInt(v)!==parseInt(m)){for(var b=h+1;b<12;b++)$("#"+v+"-"+b).addClass("active-middle");for(var b=0;b<u;b++)$("#"+m+"-"+b).addClass("active-middle");for(var w=v+1;w<m;w++)for(var b=0;b<12;b++)$("#"+w+"-"+b).addClass("active-middle")}else for(var b=h+1;b<u;b++)$("#"+v+"-"+b).addClass("active-middle");r[0].month_from=s,r[0].month_to=a,t(r)})}}.bind(r,i))};var syncScroll={settings:{canFixedScroll:!0,container:null,elem:null,inner:null,containerHeight:0,highestElem:null,lastScrollTop:0},init:function(e,t,i){syncScroll.wrapElems(e,t,function(){syncScroll.rescaleContainer(),syncScroll.bindUIActions(e,t,i)})},bindUIActions:function(e,t,i){syncScroll.onScroll(),$(window).on("scroll",function(){syncScroll.settings.canFixedScroll&&syncScroll.onScroll()}),$(window).on("resize",function(){syncScroll.rescaleContainer(),syncScroll.setHorizontalPosition()})},wrapElems:function(e,t,i){syncScroll.settings.container=e,syncScroll.settings.elem=$(".sync-outer"),syncScroll.settings.inner=$(".sync-outer .sync-inner"),"function"==typeof i&&i()},setHorizontalPosition:function(){syncScroll.settings.elem.each(function(){$(this).hasClass("fixed")?$(this).css({left:$(this).parent().offset().left,width:$(this).parent().width()}):$(this).removeAttr("style")})},rescaleContainer:function(){$(".sync-outer.high").removeClass("high"),syncScroll.settings.containerHeight=0;var e=null;syncScroll.settings.inner.each(function(){$(this).innerHeight()>syncScroll.settings.containerHeight&&(syncScroll.settings.containerHeight=$(this).innerHeight(),e=$(this))}),syncScroll.settings.container.css("height",syncScroll.settings.containerHeight),e.parent(".sync-outer").removeClass("fixed").addClass("high")},topAlign:function(e){if(e.find(".sync-inner").innerHeight()>=syncScroll.settings.containerHeight)$(window).scrollTop(syncScroll.settings.container.offset().top);else if(syncScroll.settings.canFixedScroll){syncScroll.settings.canFixedScroll=!1;var t=$(window).scrollTop(),i=syncScroll.settings.containerHeight,n=e.find(".inner").innerHeight(),s=Math.floor(i-(t+n));s<0&&(syncScroll.settings.elem.addClass("fixed").removeClass("bottom"),syncScroll.setHorizontalPosition(),$(window).scrollTop(t+s)),e.find(".sync-outer").scrollTop("0"),syncScroll.settings.lastScrollTop=t,syncScroll.settings.canFixedScroll=!0}},onScroll:function(){syncScroll.settings.elem.each(function(){$(this).hasClass("high")&&$(this).removeClass("fixed")});var e=syncScroll.settings.container,t=$(window).scrollTop(),i=t-syncScroll.settings.lastScrollTop;syncScroll.settings.container.offset().top>=$(window).scrollTop()+60?syncScroll.settings.elem.each(function(){$(this).hasClass("high")||$(this).addClass("top").removeClass("bottom fixed").removeAttr("style")}):e.offset().top+e.innerHeight()<=$(window).scrollTop()+$(window).innerHeight()?syncScroll.settings.elem.each(function(){$(this).hasClass("high")||$(this).addClass("bottom").removeClass("top fixed").removeAttr("style")}):(syncScroll.settings.elem.each(function(){var e=$(this).scrollTop()+i;$(this).hasClass("high")||($(this).hasClass("bottom")?($(this).addClass("fixed").removeClass("bottom"),$(this).scrollTop(5e16)):$(this).hasClass("top")?($(this).addClass("fixed").removeClass("top"),$(this).scrollTop("0")):($(this).addClass("fixed"),$(this).scrollTop(e)))}),syncScroll.setHorizontalPosition()),syncScroll.settings.lastScrollTop=t}},SearchModule={settings:{keyword:"",getnum:15,left_container:$(".left-container .content"),right_container:$(".right-container .content")},init:function(){this.bindUIActions()},bindUIActions:function(){$("#searchfield").on("focus",function(){$("#searchfield").select(),$("#searchlabel").addClass("not-visible")}),$("#searchfield").on("focusout",function(){""==$(this).val()&&$("#searchlabel").removeClass("not-visible")}),$("#searchicon").on("click",function(){this.settings.keyword=$("#searchfield").val().toLowerCase(),this.search(),$("#searchfield").blur(),HeaderModule.show_menu(!0)}.bind(this));var e=(new Date).getTime();$("#searchfield").on("keyup",function(t){this.settings.keyword=$("#searchfield").val().toLowerCase(),e=(new Date).getTime(),13===t.keyCode&&(this.search(),$("#searchfield").blur(),HeaderModule.show_menu(!0))}.bind(this))},search:function(e){if("undefined"==typeof e&&(e=this.settings.keyword),""===e)return void FrontPageModule.generate_front_page();for(var t=[],i=EventContentModule.settings.events,n=0;n<i.length;n++){for(var s=0,o=0,a=0,r=0,l=e.split(" "),c=0;c<l.length;c++)l[c].length>1&&(o+=2*HelpFunctions.numOfIncludes(i[n].name.toLowerCase(),l[c]),r+=4*HelpFunctions.numOfIncludes(i[n].parentname.toLowerCase(),l[c]),null!==i[n].description&&(a+=HelpFunctions.numOfIncludes(i[n].description.toLowerCase(),l[c])/2));s=o+a+r,(s>=4||o>0)&&t.push([s,i[n]])}t.sort(function(e,t){return e[0]<t[0]?1:e[0]>t[0]?-1:0});for(var i=[],n=0;n<t.length;n++)i.push(t[n][1]);i.length<=0?$(".eventscontainer").html('<div class="error">Ingen elementer fundet</div>'):(EventCalenderModule.renderEventCalender(".eventscontainer",{acceptOld:!0,getNum:0,content:i}),$(".load-more").trigger("click")),ViewHandler.closeSingleView(),$(window).trigger("resize"),setTimeout(function(){$("html,body").animate({scrollTop:$("#page-content").offset().top},200),ImageController.lazyLoad(),syncScroll.rescaleContainer()},50)}},ViewHandler={settings:{ready:!1,poly_view:!1,content_container:$(".content-container"),left_container:$("#section1 .content"),right_container:$("#section0 .content"),views:[],ls:$(".content-container-inner").position().left,centered_view:[1,2]},init:function(){$(".container-section").each(function(e,t){this.settings.views.push($(t))}.bind(this));var e,t=0,i=!1;$(document).on("click",".event",function(){ViewHandler.settings.right_container.addClass("spoopy"),EventSingleModule.render_sv_event($(this).attr("id"),function(){ViewHandler.change_view_focus(0)},$(this)),EventSingleModule.bindUIActions(),setTimeout(function(){syncScroll.rescaleContainer(),syncScroll.setHorizontalPosition(),$(window).trigger("scroll")},250),ViewHandler.toggle_poly_view(!0)}),this.settings.ready=!0},bindUIActions:function(){},change_view_focus:function(e){var t=-$(".content-container-inner").position().left,i=t+$(".content-container").innerWidth();if("number"==typeof e){var n=this.settings.views[e],s=n.position().left,o=n.position().left+n.innerWidth();s<t?(this.settings.ls=-s,$(".content-container-inner").css({left:this.settings.ls+"px"})):o>i&&(this.settings.ls=-(o-$(".content-container").innerWidth()),$(".content-container-inner").css({left:this.settings.ls+"px"}))}else if("object"==typeof e){e.sort(function(e,t){return e<t?-1:e>t?1:0;
});var a=this.settings.views[e[0]],r=this.settings.views[e[e.length-1]],l=a.position().left,c=r.position().left+r.innerWidth(),d=Math.abs(c-l);this.settings.ls=-(l-($(".content-container").innerWidth()-d)/2),$(".content-container-inner").css({left:this.settings.ls+"px"})}var g=setInterval(function(){$(window).trigger("resize")},1e3/120);setTimeout(function(){clearInterval(g)},400)},toggle_poly_view:function(e){return 1==e?(this.settings.content_container.hasClass("poly-view")||$(".monthSelector").monthPicker({remove:!0}),void this.settings.content_container.addClass("poly-view")):0==e?(this.settings.content_container.hasClass("poly-view")&&$(".monthSelector").monthPicker({remove:!0}),void this.settings.content_container.removeClass("poly-view")):(this.settings.content_container.hasClass("poly-view")?this.settings.content_container.removeClass("poly-view"):this.settings.content_container.addClass("poly-view"),void $(".monthSelector").monthPicker({remove:!0}))},go_to:function(e){},reload_view:function(e){},closeSingleView:function(){this.toggle_poly_view(!1),this.change_view_focus(this.settings.centered_view),setTimeout(function(){this.settings.right_container.html("")}.bind(this),200),null!==syncScroll.settings.inner&&setTimeout(function(){syncScroll.rescaleContainer(),$(window).trigger("resize")},300)}};$(function(){$("a").click(function(e){"#"===$(this).attr("href")&&e.preventDefault()}),$(window).on("click",function(){$(window).trigger("resize"),setTimeout(function(){syncScroll.rescaleContainer()},200)}),$(document).on("click","[data-link]",function(){"redirect"===$(this).attr("data-link-type")?window.location.href=$(this).attr("data-link"):window.open($(this).attr("data-link"))}),HeaderModule.init(),ImageController.init(),ViewHandler.init(),ViewControllerModule.init(),EventCalenderModule.init(),LocationModule.init(function(){LocationCategoryModule.init(),LocationCategoryModule.render_location_categories("#section2 .content")});var e=function(e){FrontPageModule.init(e),SearchModule.init(),EventSingleModule.init(),syncScroll.init($("#page-content"),".container-section"),setTimeout(function(){syncScroll.rescaleContainer()},150)};"app"===template?EventContentModule.init(function(t){e(t)}):(SearchModule.init(),syncScroll.init($("#page-content"),".container-section"),setTimeout(function(){syncScroll.rescaleContainer()},150)),$(".sub-page-menu").on("click","a",function(){var e=$(this).attr("href"),t=$(this).parents(".menu-item-has-children"),i=t.children("a").first(),n=i.attr("href");$(e).length?setTimeout(function(){var e=$("body").scrollTop()-80;$("body").scrollTop(e)},10):$('a[name="'+e.replace("#","")+'"]').length?setTimeout(function(){var e=$("body").scrollTop()-80;$("body").scrollTop(e)},10):window.location.href=n+e})});